@model IEnumerable<ADOPets.Web.ViewModels.SMO.IndexViewModel>
@using ADOPets.Web.Common.Extensions
@using ADOPets.Web.Common.Helpers
@using Model
@using Resources = ADOPets.Web.Resources.Wording;

@{
    ViewBag.Title = Resources.Smo_Index_PageTitle;
}


<div id="pageTitle">
    <div class="row">
        <div class="col-md-4">
            <h1>@Resources.Smo_Index_SecondOpinions</h1>
        </div>
        <div class="col-md-3">
        </div>
        <div class="col-md-3">
        </div>
        <div class="col-md-2">
            <a href="@Url.Action("NewSMO", "SMO")" class="btn btn-success pull-right" id="addSMO">
                <i class="fa fa-plus-circle"></i><span>@Resources.Smo_Index_Add</span>
            </a>
        </div>
    </div>
</div>

<div id="mainContainer">
    <div id="dvHdnTotalRecords" style="display: none;">
        @Model.Count().ToString()
    </div>

    <div class="panel panel-info">
        <div class="panel-heading">
            <h3 class="panel-title">@Resources.Smo_Index_SearchSMORequest</h3>
        </div>
        <div class="panel-body">
            <form class="form-horizontal defaultForm bv-form" role="form" novalidate="novalidate">
                <button type="submit" class="bv-hidden-submit" style="display: none; width: 0px; height: 0px;"></button>
                <button type="submit" class="bv-hidden-submit" style="display: none; width: 0px; height: 0px;"></button>
                <div class="column">
                    <div class="form-group">
                        <label for="smoStatus" class="col-md-4 control-label"><strong>@Resources.Smo_Index_Status</strong></label>
                        <div class="col-md-8">
                            @*                            @Html.TextBox("SmoStatusFilter", null, new { placeholder = Resources.Smo_Index_SearchBySMOStatusPlaceHolder, @class = "form-control" })*@
                            @Html.EnumDropDownList(typeof(SMORequestStatusEnum), "SmoStatusFilter", ViewBag.SMORequestStatus as SMORequestStatusEnum?, Resources.Smo_Index_SearchBySMOStatusPlaceHolder, new { @class = "form-control" })

                        </div>
                    </div>
                    <div class="form-group">
                        <label for="PetName" class="col-md-4 control-label"><strong>@Resources.Smo_Index_PetName</strong></label>
                        <div class="col-md-8">
                            @Html.TextBox("PetNameVDFilter", null, new { placeholder = Resources.Smo_Index_SearchByPetNamePlaceHolderVD, @class = "form-control" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Title" class="col-md-4 control-label"><strong>@Resources.Smo_Index_Title</strong></label>
                        <div class="col-md-8">
                            @Html.TextBox("SMOTitleFilter", null, new { placeholder = Resources.Smo_Index_SearchBySMOTitlePlaceHolder, @class = "form-control" })
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="form-group">
                        <label for="sMOID" class="col-md-4 control-label"><strong>@Resources.Smo_Index_SMOID</strong></label>
                        <div class="col-md-8">
                            @Html.TextBox("SMOIDFilter", null, new { placeholder = Resources.Smo_Index_SearchBySMOIDPlaceHolder, @class = "form-control" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="OwnerName" class="col-md-4 control-label"><strong>@Resources.Smo_Index_OwnerName</strong></label>
                        <div class="col-md-8">
                            @Html.TextBox("OwnerNameFilter", null, new { placeholder = Resources.Smo_Index_SearchByOwnerNamePlaceHolder, @class = "form-control" })
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </form>
        </div>
    </div>

    <h4 class="text-primary">@Resources.Smo_Index_SMORequests</h4>
    <div id="table_id_wrapper" class="dataTables_wrapper form-inline no-footer">
        <table id="table_id" class="table table-bordered dataTable no-footer" cellspacing="0" width="100%" role="grid" aria-describedby="table_id_info" style="width: 100%;">
            <thead>
                <tr role="row">
                    <th width="10%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="Pet Name: activate to sort column ascending" style="width: 41px;">@Resources.Smo_Index_PetName</th>
                    <th width="16%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="SMO ID: activate to sort column ascending" style="width: 83px;">@Resources.Smo_Index_SMOID</th>
                    <th width="15%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="Owner Name: activate to sort column ascending" style="width: 76px;">@Resources.Smo_Index_OwnerName</th>
                    <th width="26%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="Title: activate to sort column ascending" style="width: 151px;">@Resources.Smo_Index_Title</th>
                    <th width="10%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="Request Date: activate to sort column ascending" style="width: 53px;">@Resources.Smo_Index_RequestDate</th>
                    <th width="8%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width: 56px;">@Resources.Smo_Index_Status</th>
                    <th width="20%" class="sorting" tabindex="0" aria-controls="table_id" rowspan="1" colspan="1" aria-label="Action: activate to sort column ascending" style="width: 240px !important;">@Resources.Smo_Index_Action</th>
                </tr>
            </thead>
            @foreach (var item in Model)
            { 
                <tr role="row" class="odd">
                    <td class="sorting_1"><a href="@Url.Action("EditPet", "SMO", new { PetId = @item.PetId, SmoId = @item.Id })">@Html.DisplayFor(modelItem => item.PetName)</a></td>
                    <td>@Html.DisplayFor(modelItem => item.SMOId)</td>
                    <td>@Html.DisplayFor(modelItem => item.OwnerName)</td>
                    <td>@Html.DisplayFor(modelItem => item.Title)</td>
                    <td>@Html.DisplayFor(modelItem => item.RequestDate)</td>
                    <td><span id="spnRequestStatus" class="label label-primary myreqstatusspan" data-myitemid="@(item.RequestStatus)" data-item-type="request_status">
                        @Html.DisplayFor(modelItem => item.RequestStatus)
                    </span></td>
                    <td style="width: 240px !important;">
                        <a href="@Url.Action("Edit", "SMO", new { id = item.Id })" class="btn btn-primary btn-sm" data-tooltip="tooltip" data-placement="top"data-original-title="Details"><i class="fa fa-eye"></i></a>
                        @if ((item.RequestStatus != SMORequestStatusEnum.Complete.ToString()) && (item.RequestStatus != ADOPets.Web.Resources.Enums.SMOOwnerRequestStatusEnum_PaymentPending.ToString()))
                        {                            
                            <input type="hidden" id="hdnComplete" name="hdnComplete" value="@Resources.SMO_Index_InfoComplete" />
                            <input type="hidden" id="hdnInComplete" name="hdnInComplete" value="@Resources.SMO_Index_InfoInComplete" />
                            if (item.InCompleteMedicalRecord == true)
                            {
                            <button data-original-title="@Resources.SMO_Index_InfoInComplete" data-smoId="@item.Id" data-placement="top" data-tooltip="tooltip" class="dvPetInfo btn btn-warning btn-sm" style="outline:none;">
                                <input id="chk" type="hidden" value="true">
                                <span id="selectPetAnchor" class="fa fa-check-square"></span>
                            </button>
                            }
                            else
                            {
                            <button data-original-title="@Resources.SMO_Index_InfoComplete" data-smoId="@item.Id" data-placement="top" data-tooltip="tooltip" class="dvPetInfo btn btn-default btn-sm" style="outline:none;">
                                <input id="chk" type="hidden" value="false">
                                <span id="selectPetAnchor" class="fa fa-square-o"></span>
                            </button>
                            }
                        }
                        else
                        {
                            <div data-original-title="@Resources.SMO_Index_InfoComplete" data-placement="top" data-tooltip="tooltip" class="btn btn-default btn-sm customDisabled">
                                <input type="checkbox" disabled="disabled">
                            </div>
                        }
                        @if (item.RequestStatus == @ADOPets.Web.Resources.Enums.SMOOwnerRequestStatusEnum_Complete.ToString())
                        {
                            <a  href="@Url.Action("ShowSMOVetReport", "SMO", new { id = item.Id, PetId = item.PetId })" data-href="@Url.Action("ShowSMOVetReport", "SMO", new { id = item.Id, PetId = item.PetId })" class="btn btn-success btn-sm" data-tooltip="tooltip" data-placement="top" data-original-title="@Resources.Smo_Edit_Report"><i class="fa fa-download"></i></a>
                        }
                    </td>
                </tr>  
            }
        </table>
    </div>

    <div class="clearfix"></div>
    <div id="showModalReport" class="modal fade" tabindex="-1" role="dialog"></div>
</div>

<script>
    function GetTranstaltionSMOStatus() {
        var result = {
            "Open": '@ADOPets.Web.Resources.Enums.SMOOwnerRequestStatusEnum_Open',
            "InProgress": '@ADOPets.Web.Resources.Enums.SMOOwnerRequestStatusEnum_InProgress',
            "Complete": '@ADOPets.Web.Resources.Enums.SMOOwnerRequestStatusEnum_Complete',
            "PaymentPending": '@ADOPets.Web.Resources.Enums.SMOOwnerRequestStatusEnum_PaymentPending',
            "Assigned": '@ADOPets.Web.Resources.Enums.SMORequestStatusEnum_Assigned',
            "Validated": '@ADOPets.Web.Resources.Enums.SMORequestStatusEnum_Validated',
            "TestDateRequired": '@Resources.Smo_Add_TestDateRequired',
            "TestNameRequired": '@Resources.Smo_Add_TestNameRequired'
        };
        return result;
    }
    $(function () {
        $('[data-tooltip="tooltip"]').tooltip();
    });
</script>

<script src="@Url.Content("~/Scripts/external/bootstrap-confirmation.js")"></script>
<script src="@Url.Content("~/Scripts/external/pagination.js")"></script>
<script src="@Url.Content("~/Scripts/customs/views/SMO/Index_VD.js")"></script>
