@using Model
@using Resources = ADOPets.Web.Resources.Wording
@using ADOPets.Web.Common
@model ADOPets.Web.ViewModels.Pet.EditViewModel
@using ADOPets.Web.Common.Helpers
@{
    ViewBag.Title = Resources.Pet_Edit_Title;
    int userId = ViewBag.UserId;
    int petId = ViewBag.PetId;
    string fromReq = (Session[Constants.SessionCurrentUserRequestFrom] != null ? Session[Constants.SessionCurrentUserRequestFrom].ToString() : String.Empty);
    bool isOwner = HttpContext.Current.User.IsInRole(UserTypeEnum.OwnerAdmin.ToString());
    bool isVD = HttpContext.Current.User.IsInRole(UserTypeEnum.VeterinarianAdo.ToString());
}
<input type="hidden" id="PetBirthDate" value="@Model.Card.BirthDate" />
<div id="mypetmenu" class="radius3">
    <div class="btn-group btn-group-justified">
        <div class="btn-group">

            @if (ViewBag.ShareIDInformation)
            {
                if (ViewBag.ShareIDInformationActive)
                {
                <a href="@Url.Action("PetDetails", "Pet", new { id = Model.Card.Id, sharecategory = ShareCategoryTypeEnum.ShareIDInformation })"  class="btn btn-nav active">
                    <div id="petnavthumb">
                        @if (string.IsNullOrEmpty(Model.Card.ImagePath))
                        {
                            <img src="@Url.Content("~/Content/Images/animal-dimg.jpg")" id="imgTopPetImage" alt="@Resources.Pet_Edit_ImageAlt"/>
                        }
                        else
                        {
                            <img src="@Url.Action("Image", "Pet", new { fileName = Model.Card.ImagePath, userInfoPath = @ViewBag.UserInfoPath, ownerId = @ViewBag.OwnerId })" id="imgTopPetImage" alt="@Resources.Pet_Edit_ImageAlt"/>
                        }
                    </div>
                    <p id="parPetName">@Model.Card.PetName</p>
                </a>
                }
                else
                {
                <a href="@Url.Action("PetDetails", "Pet", new { id = Model.Card.Id, sharecategory = ShareCategoryTypeEnum.ShareIDInformation })"  class="btn btn-nav petEditMenu">
                    <div id="petnavthumb">
                        @if (string.IsNullOrEmpty(Model.Card.ImagePath))
                        {
                            <img src="@Url.Content("~/Content/Images/animal-dimg.jpg")" id="imgTopPetImage" alt="@Resources.Pet_Edit_ImageAlt"/>
                        }
                        else
                        {
                            <img src="@Url.Action("Image", "Pet", new { fileName = Model.Card.ImagePath, userInfoPath = @ViewBag.UserInfoPath, ownerId = @ViewBag.OwnerId })" id="imgTopPetImage" alt="@Resources.Pet_Edit_ImageAlt"/>
                        }
                    </div>
                    <p id="parPetName">@Model.Card.PetName</p>
                </a>
                }
            }
            else
            {
                <a href="#" class="btn btn-nav disabled">
                    <div id="petnavthumb">
                        <img src="@Url.Content("~/Content/Images/animal-dimg.jpg")" id="imgTopPetImage" alt="@Resources.Pet_Edit_ImageAlt"/>
                    </div>
                    <p id="parPetName">@Model.Card.PetName</p>
                </a>
            }
        </div>
        <div class="btn-group">
            @if (ViewBag.ShareMedicalRecords)
            {
                if (ViewBag.ShareMedicalRecordsActive)
                {
                <a href="#" data-href="@Url.Action("MedicalRecords", "Pet", new { id = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu active"><i class="fa fa-book"></i>
                    <p>@Resources.Pet_Edit_MedicalRecordsHeader</p>
                </a>
                }
                else
                {
                <a href="#" data-href="@Url.Action("MedicalRecords", "Pet", new { id = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu"><i class="fa fa-book"></i>
                    <p>@Resources.Pet_Edit_MedicalRecordsHeader</p>
                </a>
                }
            }
            else
            { 
                <a href="#" class="btn btn-nav petEditMenu disabled"><i class="fa fa-book"></i>
                    <p>@Resources.Pet_Edit_MedicalRecordsHeader</p>
                </a>
            }
        </div>
        <div class="btn-group">
            @if (ViewBag.ShareVeterinarians)
            {
                if (ViewBag.ShareVeterinariansActive)
                {
                <a href="#" data-href="@Url.Action("Index", "Veterinarian", new { petId = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu active"><i class="fa fa-stethoscope"></i>
                    <p>@Resources.Pet_Edit_VeterinarianHeader</p>
                </a>
                }
                else
                {  <a href="#" data-href="@Url.Action("Index", "Veterinarian", new { petId = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu"><i class="fa fa-stethoscope"></i>
                    <p>@Resources.Pet_Edit_VeterinarianHeader</p>
                </a>
                }
            }
            else
            { <a href="#" class="btn btn-nav petEditMenu disabled"><i class="fa fa-stethoscope"></i>
                <p>@Resources.Pet_Edit_VeterinarianHeader</p>
            </a>
            }
        </div>
        <div class="btn-group">
            @if (ViewBag.ShareContacts)
            {
                if (ViewBag.ShareContactsActive)
                {
                <a href="#" data-href="@Url.Action("Index", "PetContact", new { petId = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu active"><i class="fa fa-phone-square"></i>
                    <p>@Resources.Pet_Edit_ContactsHeader</p>
                </a>
                }
                else
                { <a href="#" data-href="@Url.Action("Index", "PetContact", new { petId = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu"><i class="fa fa-phone-square"></i>
                    <p>@Resources.Pet_Edit_ContactsHeader</p>
                </a>
                }
            }
            else
            { <a href="#" class="btn btn-nav petEditMenu disabled"><i class="fa fa-phone-square"></i>
                <p>@Resources.Pet_Edit_ContactsHeader</p>
            </a>
            }
        </div>
        <div class="btn-group">
            @if (ViewBag.ShareGallery)
            {
                if (ViewBag.ShareGalleryActive)
                {
                <a href="#" data-href="@Url.Action("Index", "PhotoGallery", new { petId = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu active"><i class="fa fa-image (alias)"></i>
                    <p>@Resources.Pet_Edit_GalleryHeader</p>
                </a>
                }
                else
                {
                <a href="#" data-href="@Url.Action("Index", "PhotoGallery", new { petId = Model.Card.Id })" data-toggle="tab" class="btn btn-nav petEditMenu"><i class="fa fa-image (alias)"></i>
                    <p>@Resources.Pet_Edit_GalleryHeader</p>
                </a>
                }
            }
            else
            { <a href="#" class="btn btn-nav petEditMenu disabled"><i class="fa fa-image (alias)"></i>
                <p>@Resources.Pet_Edit_GalleryHeader</p>
            </a>
            }
        </div>
    </div>
</div>

@if (Roles.IsUserInRole(UserTypeEnum.Admin.ToString()))
{
    <div id="pageTitle">
        <div class="row">
            <div class="col-md-8">
                <h1>@Resources.Pet_Edit_AdminOwner : @ViewBag.OwnerName</h1>
            </div>
        </div>
    </div>
}


<div id="mainContainer">
    @if (!Roles.IsUserInRole(UserTypeEnum.VeterinarianAdo.ToString()) && !Roles.IsUserInRole(UserTypeEnum.VeterinarianLight.ToString()) && !Roles.IsUserInRole(UserTypeEnum.VeterinarianExpert.ToString()) && !Roles.IsUserInRole(UserTypeEnum.Admin.ToString()))
    {
        <div id="hiderightsidebar">
            <img src="@Url.Content("~/Content/images/hide-img.png")" width="22" height="34" alt="" />
        </div>
        <div id="showrightsidebar">
            <img src="@Url.Content("~/Content/images/show-img.png")" width="22" height="34" alt="" />
        </div>
    }


    <div id="buble" class="dynDiv_moveDiv animated zoomInDown" style="cursor: move;">
        <div id="bubleContent">
            @String.Format("{0} - {1}", Resources.Pet_Edit_OwnerId, ViewBag.OwnerId)
            <br>
            @String.Format("{0} - {1}", Resources.Pet_Edit_FirstName, ViewBag.OwnerFirstName)<br>
            @String.Format("{0} - {1}", Resources.Pet_Edit_LastName, ViewBag.OwnerLastName)<br>
            <div id="bubleBottom">
                <a href="@Url.Action("Index", "Pet")">@Resources.Pet_Edit_BackToPets</a> | 
                    <a href="@Url.Action("OwnerProfile", "Profile", new { id = @ViewBag.OwnerId, petId = @Model.Card.Id })" 
                    data-tooltip="tooltip" data-placement="top" title="@Resources.Pet_Index_OwnerDetail"><i class="fa fa-eye" style="padding-right: 0;"></i></a>| 
                    <a href="javascript:void(0)" id="minimizeBuble"><i class="fa fa-compress" style="padding-right: 0;"></i></a>
            </div>
        </div>
        <a href="javascript:void(0)" id="maximizeBuble"><i class="fa fa-expand" style="padding-right: 0;"></i></a>
    </div>



    <div id="dvMiddleContainer">
        <div id="dvPetImage">
            @Html.Partial("_PetImage", Model.Card)
        </div>
        <div id="profilenavbtn">
            <a href="javascript:void(0)" class="btn btn-default" id="showinsurancedetails">@Resources.Pet_Edit_Insurance</a>
            <a href="javascript:void(0)" class="btn btn-default" id="showbreederdetails">@Resources.Pet_Edit_Breeder</a>
            <a href="javascript:void(0)" class="btn btn-success" id="showpetdetails">@Resources.Pet_Edit_PetDetail</a>

            <div class="clearfix"></div>
        </div>

        <div id="dvAllData">
            <div id="petdetails">
                @Html.Partial("_CardDetail", Model.Card)
            </div>
            <div id="breederdetails">
                @Html.Partial("_BreederDetail", Model.BreederEdit)
            </div>
        </div>
        <div id="insurancedetails">
            @Html.Partial("~/Views/Insurance/_Index.cshtml", Model.Insurances)
        </div>
    </div>
</div>
<div class="clearfix"></div>
<div id="addModalInsurance" class="modal fade" tabindex="-1" role="dialog"></div>
<div id="addModalNewMessage" class="modal fade" tabindex="-1" role="dialog"></div>
<script>

    $(document).ready(function () {
        $("#dvMiddleContainer").load($("#mypetmenu").find('a.active').attr('data-href'));
        $('[data-tooltip="tooltip"]').tooltip();
        $("#breederdetails,#insurancedetails,#addInsurance").hide();
        $("#cardEdit").show();
        $("#profileeditbtn").hide();
        $("#breederEdit").hide();
        var temp = '@isOwner';
        var temp1 = '@Session["IncompleteMedicalRecord"]';
        var vdmessage = '@isVD';

        if (temp.toString().toLowerCase() == "true" && temp1.toString().toLowerCase() == "false") {
            ShowAjaxWarningMessage("@Resources.SMO_Index_InProgressMessage");
        }
        else if (vdmessage.toString().toLocaleLowerCase() == "true" && temp1.toString().toLowerCase() == "false") {
            ShowAjaxWarningMessage("@Resources.SMO_Index_InProgressMessage");
        }
    });

</script>

<script src="@Url.Content("~/Scripts/customs/views/Pet/CardDetail.js")"></script>
<link href="@Url.Content("~/Content/css/jquery.fancybox-1.3.4.css")" rel="stylesheet">
<script src="@Url.Content("~/Scripts/external/jquery.fancybox-1.3.4.js")"></script>
<script src="@Url.Content("~/Scripts/external/byrei-dyndiv_1.0rc1.js")"></script>

